import{v as C,c as N,B as P,j as T,M as q,S as f,s as n,a as y,F as w,b as G,T as D,$ as M,_ as U,d as r,l as b,U as B,A as v,e as Q,f as $}from"./index.033f7a07.js";import{G as K}from"./AgGridComponent.vue_vue_type_style_index_0_lang.fa2b8661.39d83dec.js";import{k as A,w as L,b as k}from"./formatMoney.0cf77808.c83e9a63.js";const x=C({__name:"AgGridMenuItemSuppliesComponent",props:{menuItem:null,suppliesList:null},emits:["menuItemSupplyUpdated","menuItemSupplyDeleted"],setup(u,{emit:s}){const l=u,c=e=>s("menuItemSupplyUpdated",e),I=e=>s("menuItemSupplyDeleted",e),i=N({items:l.menuItem.menuItemSupplies});P(l.menuItem,e=>{const p=new Set(i.items),o=new Set(e.menuItemSupplies),S=[...o].filter(d=>!p.has(d)),_=[...p].filter(d=>!o.has(d));i.items=i.items.filter(d=>!_.includes(d)).concat(S)});const m=[{field:"supplyDetails",cellEditor:A,cellEditorParams:{options:l.suppliesList.items.map(e=>({value:`${e.supplyName}`,label:`${e.supplyName}`}))},valueGetter:({data:e})=>{const p=l.suppliesList.items.find(S=>S.uniqueId==e.supplyUniqueId),o=L(p.purchasePriceBeforeTax/p.purchaseQuantity);return`${p.supplyName} @ ${o} per ${p.supplyUnits}`}},{field:"supplyQuantity",valueParser:e=>Number(e.newValue)},{field:"supplyCost",headerName:"Supply Cost (Calculated)",editable:!1,valueGetter:({data:e})=>{const p=l.suppliesList.items.find(o=>o.uniqueId==e.supplyUniqueId);return e.supplyQuantity*(p.purchasePriceBeforeTax/p.purchaseQuantity)},valueFormatter:e=>L(e.value)}];return(e,p)=>(v(),T(K,{gridData:i,gridColumns:["supplyDetails","supplyQuantity","supplyCost"],gridColumnDefs:m,onGridDataUpdate:c,onGridRowDelete:I},null,8,["gridData"]))}}),F=u=>(Q("data-v-1706aa7e"),u=u(),$(),u),V=F(()=>n("option",{disabled:"",value:null},"Please select one",-1)),j=["value"],E=["enabled"],R=C({__name:"FrcSelectOption",props:{title:null,options:null,optionKey:null},emits:["submitSelect"],setup(u,{emit:s}){const l=q(null),c=()=>{s("submitSelect",l.value),l.value=null};return(I,i)=>(v(),f("fieldset",null,[n("label",null,y(u.title),1),w(n("select",{"onUpdate:modelValue":i[0]||(i[0]=m=>l.value=m)},[V,(v(!0),f(D,null,M(u.options,m=>(v(),f("option",{value:m},y(m[u.optionKey]),9,j))),256))],512),[[G,l.value]]),n("button",{enabled:l.value!=null,onClick:c}," Add "+y(l.value?.[u.optionKey]),9,E)]))}}),g=k(R,[["__scopeId","data-v-1706aa7e"]]),z=n("dt",null,"Total Cost",-1),O=n("dt",null,"Recommended Menu Price @ 3.5",-1),W=C({__name:"MenuItemView",props:{menuItem:null,suppliesList:null,sendCommand:null},setup(u){const s=u,l=s.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="ingredient");q({});const c=s.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="packaging"),I=t=>{const a={uniqueId:crypto.randomUUID(),menuItemUniqueId:s.menuItem.uniqueId,supplyUniqueId:t.uniqueId,supplyName:t.supplyName};s.sendCommand({type:"add_supply_to_menu_item",payload:a})},i=t=>I(t),m=t=>I(t),e=t=>s.sendCommand({type:"update_supply_on_menu_item",payload:t}),p=t=>s.sendCommand({type:"remove_supply_from_menu_item",payload:t}),o=()=>s.menuItem.menuItemSupplies.map(t=>{const a=s.suppliesList.items.find(h=>h.uniqueId==t.supplyUniqueId);return{unitPrice:a==null?0:a.purchasePriceBeforeTax/a.purchaseQuantity,...t}}).reduce((t,a)=>t+a.supplyQuantity*a.unitPrice,0),S=()=>_.value*3.5,_=U(()=>o()),d=U(()=>S());return(t,a)=>(v(),f(D,null,[n("h2",null,y(u.menuItem.menuItemName),1),n("dl",null,[n("div",null,[z,n("dd",null,y(r(L)(r(_))),1)]),n("div",null,[O,n("dd",null,y(r(L)(r(d))),1)])]),n("form",{onSubmit:a[0]||(a[0]=B(()=>{},["prevent"]))},[b(g,{title:"Ingredient",options:r(l),optionKey:"supplyName",onSubmitSelect:i},null,8,["options"]),b(g,{title:"Packaging",options:r(c),optionKey:"supplyName",onSubmitSelect:m},null,8,["options"])],32),b(x,{menuItem:u.menuItem,suppliesList:u.suppliesList,onMenuItemSupplyUpdated:e,onMenuItemSupplyDeleted:p},null,8,["menuItem","suppliesList"])],64))}});export{W as default};
