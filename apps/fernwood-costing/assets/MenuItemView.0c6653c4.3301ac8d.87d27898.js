import{E as C,u as h,q as P,M as f,N as T,V as q,I as _,s as p,a as y,L as $,z as w,$ as N,U as F,g as U,b as r,i as g,K,T as M,c as Q}from"./index.f7e799af.js";import{F as V}from"./AgGridComponent.vue_vue_type_style_index_0_lang.fa2b8661.39d83dec.a6d67679.js";import{T as x,g as L,F as E}from"./formatMoney.0cf77808.c83e9a63.80c3045c.js";const G=C({__name:"AgGridMenuItemSuppliesComponent",props:{menuItem:null,suppliesList:null},emits:["menuItemSupplyUpdated","menuItemSupplyDeleted"],setup(l,{emit:s}){const u=l,c=e=>s("menuItemSupplyUpdated",e),I=e=>s("menuItemSupplyDeleted",e),i=h({items:u.menuItem.menuItemSupplies});P(u.menuItem,e=>{const n=new Set(i.items),o=new Set(e.menuItemSupplies),S=[...o].filter(d=>!n.has(d)),v=[...n].filter(d=>!o.has(d));i.items=i.items.filter(d=>!v.includes(d)).concat(S)});const m=[{field:"supplyDetails",cellEditor:x,cellEditorParams:{options:u.suppliesList.items.map(e=>({value:`${e.supplyName}`,label:`${e.supplyName}`}))},valueGetter:({data:e})=>{const n=u.suppliesList.items.find(S=>S.uniqueId==e.supplyUniqueId),o=L(n.purchasePriceBeforeTax/n.purchaseQuantity);return`${n.supplyName} @ ${o} per ${n.supplyUnits}`}},{field:"supplyQuantity",valueParser:e=>Number(e.newValue)},{field:"supplyCost",headerName:"Supply Cost (Calculated)",editable:!1,valueGetter:({data:e})=>{const n=u.suppliesList.items.find(o=>o.uniqueId==e.supplyUniqueId);return e.supplyQuantity*(n.purchasePriceBeforeTax/n.purchaseQuantity)},valueFormatter:e=>L(e.value)}];return(e,n)=>(f(),T(V,{gridData:i,gridColumns:["supplyDetails","supplyQuantity","supplyCost"],gridColumnDefs:m,onGridDataUpdate:c,onGridRowDelete:I},null,8,["gridData"]))}}),k=l=>(M("data-v-1706aa7e"),l=l(),Q(),l),z=k(()=>p("option",{disabled:"",value:null},"Please select one",-1)),B=["value"],R=["enabled"],A=C({__name:"FrcSelectOption",props:{title:null,options:null,optionKey:null},emits:["submitSelect"],setup(l,{emit:s}){const u=q(null),c=()=>{s("submitSelect",u.value),u.value=null};return(I,i)=>(f(),_("fieldset",null,[p("label",null,y(l.title),1),$(p("select",{"onUpdate:modelValue":i[0]||(i[0]=m=>u.value=m)},[z,(f(!0),_(N,null,F(l.options,m=>(f(),_("option",{value:m},y(m[l.optionKey]),9,B))),256))],512),[[w,u.value]]),p("button",{enabled:u.value!=null,onClick:c}," Add "+y(u.value?.[l.optionKey]),9,R)]))}}),b=E(A,[["__scopeId","data-v-1706aa7e"]]),O=p("dt",null,"Total Cost",-1),j=p("dt",null,"Recommended Menu Price @ 3.5",-1),X=C({__name:"MenuItemView",props:{menuItem:null,suppliesList:null,sendCommand:null},setup(l){const s=l,u=s.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="ingredient");q({});const c=s.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="packaging"),I=t=>{const a={uniqueId:crypto.randomUUID(),menuItemUniqueId:s.menuItem.uniqueId,supplyUniqueId:t.uniqueId,supplyName:t.supplyName};s.sendCommand({type:"add_supply_to_menu_item",payload:a})},i=t=>I(t),m=t=>I(t),e=t=>s.sendCommand({type:"update_supply_on_menu_item",payload:t}),n=t=>s.sendCommand({type:"remove_supply_from_menu_item",payload:t}),o=()=>s.menuItem.menuItemSupplies.map(t=>{const a=s.suppliesList.items.find(D=>D.uniqueId==t.supplyUniqueId);return{unitPrice:a==null?0:a.purchasePriceBeforeTax/a.purchaseQuantity,...t}}).reduce((t,a)=>t+a.supplyQuantity*a.unitPrice,0),S=()=>v.value*3.5,v=U(()=>o()),d=U(()=>S());return(t,a)=>(f(),_(N,null,[p("h2",null,y(l.menuItem.menuItemName),1),p("dl",null,[p("div",null,[O,p("dd",null,y(r(L)(r(v))),1)]),p("div",null,[j,p("dd",null,y(r(L)(r(d))),1)])]),p("form",{onSubmit:a[0]||(a[0]=K(()=>{},["prevent"]))},[g(b,{title:"Ingredient",options:r(u),optionKey:"supplyName",onSubmitSelect:i},null,8,["options"]),g(b,{title:"Packaging",options:r(c),optionKey:"supplyName",onSubmitSelect:m},null,8,["options"])],32),g(G,{menuItem:l.menuItem,suppliesList:l.suppliesList,onMenuItemSupplyUpdated:e,onMenuItemSupplyDeleted:n},null,8,["menuItem","suppliesList"])],64))}});export{X as default};
