import{d as C,r as M,w as N,c as P,o as f,a as D,b as v,e as p,t as r,f as k,v as q,F as U,g as $,p as x,h as T,i as w,u as d,j as h,k as B}from"./index.2a660d36.js";import{_ as Q}from"./AgGridComponent.vue_vue_type_style_index_0_lang.fa2b8661.js";import{A as F,f as g,_ as O}from"./formatMoney.0cf77808.js";const V=C({__name:"AgGridMenuItemSuppliesComponent",props:{menuItem:null,suppliesList:null},emits:["menuItemSupplyUpdated","menuItemSupplyDeleted"],setup(n,{emit:l}){const s=n,y=e=>l("menuItemSupplyUpdated",e),I=e=>l("menuItemSupplyDeleted",e),i=M({items:s.menuItem.menuItemSupplies});N(s.menuItem,e=>{const u=new Set(i.items),m=new Set(e.menuItemSupplies),_=[...m].filter(c=>!u.has(c)),S=[...u].filter(c=>!m.has(c));i.items=i.items.filter(c=>!S.includes(c)).concat(_)});const a=[{field:"supplyDetails",cellEditor:F,cellEditorParams:{options:s.suppliesList.items.map(e=>({value:`${e.supplyName}`,label:`${e.supplyName}`}))},valueGetter:({data:e})=>{const u=s.suppliesList.items.find(_=>_.uniqueId==e.supplyUniqueId),m=g(u.purchasePriceBeforeTax/u.purchaseQuantity);return`${u.supplyName} @ ${m} per ${u.supplyUnits}`}},{field:"supplyQuantity",valueParser:e=>Number(e.newValue)},{field:"supplyCost",headerName:"Supply Cost (Calculated)",editable:!1,valueGetter:({data:e})=>{const u=s.suppliesList.items.find(m=>m.uniqueId==e.supplyUniqueId);return e.supplyQuantity*(u.purchasePriceBeforeTax/u.purchaseQuantity)},valueFormatter:e=>g(e.value)}];return(e,u)=>(f(),P(Q,{gridData:i,gridColumns:["supplyDetails","supplyQuantity","supplyCost"],gridColumnDefs:a,onGridDataUpdate:y,onGridRowDelete:I},null,8,["gridData"]))}}),G=n=>(x("data-v-1706aa7e"),n=n(),T(),n),K=G(()=>p("option",{disabled:"",value:null},"Please select one",-1)),A=["value"],E=["enabled"],R=C({__name:"FrcSelectOption",props:{title:null,options:null,optionKey:null},emits:["submitSelect"],setup(n,{emit:l}){const s=D(null),y=()=>{l("submitSelect",s.value),s.value=null};return(I,i)=>(f(),v("fieldset",null,[p("label",null,r(n.title),1),k(p("select",{"onUpdate:modelValue":i[0]||(i[0]=a=>s.value=a)},[K,(f(!0),v(U,null,$(n.options,a=>(f(),v("option",{value:a},r(a[n.optionKey]),9,A))),256))],512),[[q,s.value]]),p("button",{enabled:s.value!=null,onClick:y}," Add "+r(s.value?.[n.optionKey]),9,E)]))}});const L=O(R,[["__scopeId","data-v-1706aa7e"]]),j=p("dt",null,"Total Cost",-1),z=p("dt",null,"Recommended Menu Price @ 3.5",-1),Y=C({__name:"MenuItemView",props:{menuItem:null,suppliesList:null,sendCommand:null},setup(n){const l=n,s=l.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="ingredient");D({});const y=l.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="packaging"),I=t=>{const o={uniqueId:crypto.randomUUID(),menuItemUniqueId:l.menuItem.uniqueId,supplyUniqueId:t.uniqueId,supplyName:t.supplyName};l.sendCommand({type:"add_supply_to_menu_item",payload:o})},i=t=>I(t),a=t=>I(t),e=t=>l.sendCommand({type:"update_supply_on_menu_item",payload:t}),u=t=>l.sendCommand({type:"remove_supply_from_menu_item",payload:t}),m=()=>l.menuItem.menuItemSupplies.map(t=>{const o=l.suppliesList.items.find(b=>b.uniqueId==t.supplyUniqueId);return{unitPrice:o==null?0:o.purchasePriceBeforeTax/o.purchaseQuantity,...t}}).reduce((t,o)=>t+o.supplyQuantity*o.unitPrice,0),_=()=>S.value*3.5,S=w(()=>m()),c=w(()=>_());return(t,o)=>(f(),v(U,null,[p("h2",null,r(n.menuItem.menuItemName),1),p("dl",null,[p("div",null,[j,p("dd",null,r(d(g)(d(S))),1)]),p("div",null,[z,p("dd",null,r(d(g)(d(c))),1)])]),p("form",{onSubmit:o[0]||(o[0]=B(()=>{},["prevent"]))},[h(L,{title:"Ingredient",options:d(s),optionKey:"supplyName",onSubmitSelect:i},null,8,["options"]),h(L,{title:"Packaging",options:d(y),optionKey:"supplyName",onSubmitSelect:a},null,8,["options"])],32),h(V,{menuItem:n.menuItem,suppliesList:n.suppliesList,onMenuItemSupplyUpdated:e,onMenuItemSupplyDeleted:u},null,8,["menuItem","suppliesList"])],64))}});export{Y as default};
