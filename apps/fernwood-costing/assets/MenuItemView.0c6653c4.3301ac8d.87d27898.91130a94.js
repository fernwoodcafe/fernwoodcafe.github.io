import{E as b,u as h,q as P,V as S,z as w,B as q,N as _,s as p,a as y,D as B,J as Q,R as D,W as T,g as L,b as r,i as U,X as G,U as V,c as x}from"./index.935dcb02.js";import{F as K}from"./AgGridComponent.vue_vue_type_style_index_0_lang.fa2b8661.39d83dec.a6d67679.57858042.js";import{T as M,U as C,x as R}from"./formatMoney.0cf77808.c83e9a63.80c3045c.ce30408e.js";const $=b({__name:"AgGridMenuItemSuppliesComponent",props:{menuItem:null,suppliesList:null},emits:["menuItemSupplyUpdated","menuItemSupplyDeleted"],setup(u,{emit:n}){const l=u,c=e=>n("menuItemSupplyUpdated",e),I=e=>n("menuItemSupplyDeleted",e),i=h({items:l.menuItem.menuItemSupplies});P(l.menuItem,e=>{const s=new Set(i.items),o=new Set(e.menuItemSupplies),v=[...o].filter(d=>!s.has(d)),f=[...s].filter(d=>!o.has(d));i.items=i.items.filter(d=>!f.includes(d)).concat(v)});const m=[{field:"supplyDetails",cellEditor:M,cellEditorParams:{options:l.suppliesList.items.map(e=>({value:`${e.supplyName}`,label:`${e.supplyName}`}))},valueGetter:({data:e})=>{const s=l.suppliesList.items.find(v=>v.uniqueId==e.supplyUniqueId),o=C(s.purchasePriceBeforeTax/s.purchaseQuantity);return`${s.supplyName} @ ${o} per ${s.supplyUnits}`}},{field:"supplyQuantity",valueParser:e=>Number(e.newValue)},{field:"supplyCost",headerName:"Supply Cost (Calculated)",editable:!1,valueGetter:({data:e})=>{const s=l.suppliesList.items.find(o=>o.uniqueId==e.supplyUniqueId);return e.supplyQuantity*(s.purchasePriceBeforeTax/s.purchaseQuantity)},valueFormatter:e=>C(e.value)}];return(e,s)=>(S(),w(K,{gridData:i,gridColumns:["supplyDetails","supplyQuantity","supplyCost"],gridColumnDefs:m,onGridDataUpdate:c,onGridRowDelete:I},null,8,["gridData"]))}}),k=u=>(V("data-v-1706aa7e"),u=u(),x(),u),E=k(()=>p("option",{disabled:"",value:null},"Please select one",-1)),F=["value"],z=["enabled"],A=b({__name:"FrcSelectOption",props:{title:null,options:null,optionKey:null},emits:["submitSelect"],setup(u,{emit:n}){const l=q(null),c=()=>{n("submitSelect",l.value),l.value=null};return(I,i)=>(S(),_("fieldset",null,[p("label",null,y(u.title),1),B(p("select",{"onUpdate:modelValue":i[0]||(i[0]=m=>l.value=m)},[E,(S(!0),_(D,null,T(u.options,m=>(S(),_("option",{value:m},y(m[u.optionKey]),9,F))),256))],512),[[Q,l.value]]),p("button",{enabled:l.value!=null,onClick:c}," Add "+y(l.value?.[u.optionKey]),9,z)]))}}),g=R(A,[["__scopeId","data-v-1706aa7e"]]),X=p("dt",null,"Total Cost",-1),J=p("dt",null,"Recommended Menu Price @ 3.5",-1),H=b({__name:"MenuItemView",props:{menuItem:null,suppliesList:null,sendCommand:null},setup(u){const n=u,l=n.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="ingredient");q({});const c=n.suppliesList.items.filter(t=>t.supplyType.toLocaleLowerCase()=="packaging"),I=t=>{const a={uniqueId:crypto.randomUUID(),menuItemUniqueId:n.menuItem.uniqueId,supplyUniqueId:t.uniqueId,supplyName:t.supplyName};n.sendCommand({type:"add_supply_to_menu_item",payload:a})},i=t=>I(t),m=t=>I(t),e=t=>n.sendCommand({type:"update_supply_on_menu_item",payload:t}),s=t=>n.sendCommand({type:"remove_supply_from_menu_item",payload:t}),o=()=>n.menuItem.menuItemSupplies.map(t=>{const a=n.suppliesList.items.find(N=>N.uniqueId==t.supplyUniqueId);return{unitPrice:a==null?0:a.purchasePriceBeforeTax/a.purchaseQuantity,...t}}).reduce((t,a)=>t+a.supplyQuantity*a.unitPrice,0),v=()=>f.value*3.5,f=L(()=>o()),d=L(()=>v());return(t,a)=>(S(),_(D,null,[p("h2",null,y(u.menuItem.menuItemName),1),p("dl",null,[p("div",null,[X,p("dd",null,y(r(C)(r(f))),1)]),p("div",null,[J,p("dd",null,y(r(C)(r(d))),1)])]),p("form",{onSubmit:a[0]||(a[0]=G(()=>{},["prevent"]))},[U(g,{title:"Ingredient",options:r(l),optionKey:"supplyName",onSubmitSelect:i},null,8,["options"]),U(g,{title:"Packaging",options:r(c),optionKey:"supplyName",onSubmitSelect:m},null,8,["options"])],32),U($,{menuItem:u.menuItem,suppliesList:u.suppliesList,onMenuItemSupplyUpdated:e,onMenuItemSupplyDeleted:s},null,8,["menuItem","suppliesList"])],64))}});export{H as default};
